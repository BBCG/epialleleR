<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>preprocessBam — preprocessBam • epialleleR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="preprocessBam — preprocessBam"><meta name="description" content="This function reads and preprocesses BAM file."><meta property="og:description" content="This function reads and preprocesses BAM file."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">epialleleR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.13.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/epialleleR.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/values.html">The epialleleR output values &lt;img style="float: right;" src="epialleleR_logo.svg"&gt; </a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/BBCG/epialleleR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>preprocessBam</h1>
      <small class="dont-index">Source: <a href="https://github.com/BBCG/epialleleR/blob/devel/R/preprocessBam.R" class="external-link"><code>R/preprocessBam.R</code></a></small>
      <div class="d-none name"><code>preprocessBam.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function reads and preprocesses BAM file.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">preprocessBam</span><span class="op">(</span></span>
<span>  <span class="va">bam.file</span>,</span>
<span>  paired <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  min.mapq <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  min.baseq <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  min.prob <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>,</span>
<span>  highest.prob <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  skip.duplicates <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  skip.secondary <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  skip.qcfail <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  skip.supplementary <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  trim <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  nthreads <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-bam-file">bam.file<a class="anchor" aria-label="anchor" href="#arg-bam-file"></a></dt>
<dd><p>BAM file location string.</p></dd>


<dt id="arg-paired">paired<a class="anchor" aria-label="anchor" href="#arg-paired"></a></dt>
<dd><p>boolean for expected alignment endness: `TRUE` for paired-end,
`FALSE` for single-end, or `NULL` for auto detect (the default).</p></dd>


<dt id="arg-min-mapq">min.mapq<a class="anchor" aria-label="anchor" href="#arg-min-mapq"></a></dt>
<dd><p>non-negative integer threshold for minimum read mapping
quality (default: 0).</p></dd>


<dt id="arg-min-baseq">min.baseq<a class="anchor" aria-label="anchor" href="#arg-min-baseq"></a></dt>
<dd><p>non-negative integer threshold for minimum nucleotide base
quality (default: 0).</p></dd>


<dt id="arg-min-prob">min.prob<a class="anchor" aria-label="anchor" href="#arg-min-prob"></a></dt>
<dd><p>integer threshold for minimum scaled probability of
modification (methylation) to consider. Affects processing long-read
sequencing alignments only. According to SAM/BAM specification, the
continuous base modification probability range 0.0 to 1.0 is
remapped in equal sized portions to the discrete integers 0 to 255
inclusively. If default (-1), then all C+m and G-m cytosine
methylation modifications recorded in MM/Mm tag will be included, even if
ML/Ml tag with probabilities is absent (in such case, probability of
modification equals -1).</p></dd>


<dt id="arg-highest-prob">highest.prob<a class="anchor" aria-label="anchor" href="#arg-highest-prob"></a></dt>
<dd><p>boolean defining if methylation modification must have
the highest probability among all modifications at a particular base to be
considered in the analyses (default: TRUE). Affects processing long-read
sequencing alignments only. If default (TRUE) and ML/Ml tag with probability
scores is absent, then cytosines with more than one modification will be
omitted (as the probability of all modifications will be equal).</p></dd>


<dt id="arg-skip-duplicates">skip.duplicates<a class="anchor" aria-label="anchor" href="#arg-skip-duplicates"></a></dt>
<dd><p>boolean defining if duplicate aligned reads should be
skipped (default: FALSE). Option has no effect if duplicate reads were not
marked by alignment software.</p></dd>


<dt id="arg-skip-secondary">skip.secondary<a class="anchor" aria-label="anchor" href="#arg-skip-secondary"></a></dt>
<dd><p>boolean defining if secondary alignments should be
skipped (default: TRUE). Do not change.</p></dd>


<dt id="arg-skip-qcfail">skip.qcfail<a class="anchor" aria-label="anchor" href="#arg-skip-qcfail"></a></dt>
<dd><p>boolean defining if alignments failing QC should be
skipped (default: TRUE). Do not change.</p></dd>


<dt id="arg-skip-supplementary">skip.supplementary<a class="anchor" aria-label="anchor" href="#arg-skip-supplementary"></a></dt>
<dd><p>boolean defining if supplementary alignments
should be skipped (default: TRUE). Do not change.</p></dd>


<dt id="arg-trim">trim<a class="anchor" aria-label="anchor" href="#arg-trim"></a></dt>
<dd><p>non-negative integer or vector of length 2 for the number of
nucleotide bases to be trimmed from 5' and 3' ends of a template (i.e.,
read pair for paired-end BAM or read for single-end BAM).
Default: 0 for no trimming. Specifying `trim=1` will result in removing of
a single base from both ends, while specifying `trim=c(1,2)` will
result in removing of a single base from 5' end and 2 bases from 3' end.</p></dd>


<dt id="arg-nthreads">nthreads<a class="anchor" aria-label="anchor" href="#arg-nthreads"></a></dt>
<dd><p>non-negative integer for the number of additional HTSlib
threads to be used during BAM file decompression (default: 1). Two threads
(and usually no more than two) make sense for the files larger than 100 MB.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>boolean to report progress and timings (default: TRUE).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code><a href="https://rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></code> object containing preprocessed
BAM data.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function loads and preprocesses BAM file, saving time when multiple
analyses are to be performed on large input files. Currently, HTSlib
is used to read the data, therefore it is possible to speed up the loading
by means of HTSlib decompression threads.</p>
<p>This function is also called internally when BAM file location is supplied as
an input for other `epialleleR` methods.</p>
<p>`preprocessBam` currently allows to load both short-read (e.g., bisulfite)
and long-read (native) sequencing alignments. Specific requirements for these
types of data are given below.</p>
    </div>
    <div class="section level2">
    <h2 id="short-read-sequencing">Short-read sequencing<a class="anchor" aria-label="anchor" href="#short-read-sequencing"></a></h2>



<p>For preprocessing of short reads (and therefore for all reporting
methods), `epialleleR` requires genomic
strand (XG tag) and a methylation call string (XM tag) to be present in a
BAM file - i.e., methylation calling must be performed after read
mapping/alignment by your software of choice. It is the case for BAM files
produced by Bismark Bisulfite Read Mapper and Methylation Caller,
Illumina DRAGEN, Illumina Cloud analysis solutions, as well as
contemporary Illumina sequencing instruments
with on-board read mapping/alignment (NextSeq 1000/2000, NovaSeq X),
therefore such files can be analysed without additional steps.
For alignments produced by other tools, e.g., BWA-meth or BSMAP, methylation
calling must be performed prior to BAM loading / reporting, by means of
<code><a href="callMethylation.html">callMethylation</a></code>.</p>
    </div>
    <div class="section level2">
    <h2 id="long-read-sequencing">Long-read sequencing<a class="anchor" aria-label="anchor" href="#long-read-sequencing"></a></h2>



<p>For preprocessing of long reads, `epialleleR` requires presence of MM (Mm)
and ML (Ml) tags that hold information on base modifications and related
probabilities, respectively. These are standard tags described in SAM/BAM
format specification, therefore relevant tools for analysis and alignment
of long sequencing reads should be able to produce them.</p>
    </div>
    <div class="section level2">
    <h2 id="other-details">Other details<a class="anchor" aria-label="anchor" href="#other-details"></a></h2>



<p>`preprocessBam` always tests if BAM file is paired- or single-ended
and has all necessary tags available. It is recommended to use
`verbose` processing and check messages for correct identification of
alignment endness. Otherwise, if the `paired` parameter is set explicitly,
exception is thrown when expected endness differs from the auto detected one.</p>
<p>During preprocessing of paired-end alignments, paired reads are merged
according to
their base quality: nucleotide base with the highest value in the QUAL string
is taken, unless its quality is less than `min.baseq`, which results in no
information for that particular position ("-"/"N"). These merged reads are
then processed as a single entity in all `epialleleR` methods. Due to
merging, overlapping bases in read pairs are counted only once, and the base
with the highest quality is taken.</p>
<p>During preprocessing of single-end alignments, no read merging is
performed. Only bases with quality of at least `min.baseq` are considered.
Lower base quality results in no information for that particular position
("-"/"N").</p>
<p>For RRBS-like protocols, it is possible to trim alignments from one or both
ends. Trimming is performed during BAM loading and will therefore influence
results of all downstream `epialleleR` methods. Internally, trimming is
performed at the level of a template (i.e., read pair for paired-end BAM or
individual read for single-end BAM). This ensures that only necessary parts
(real ends of sequenced fragment) are removed for paired-end sequencing
reads.</p>
<p>It is also a requirement currently that paired-end BAM file must be sorted by
QNAME instead
of genomic location (i.e., "unsorted") to perform merging of paired-end
reads. Error message is shown if it is sorted by genomic location, in this
case please sort it by QNAME using 'samtools sort -n -o out.bam in.bam'.</p>
    </div>
    <div class="section level2">
    <h2 id="specific-considerations-for-long-read-sequencing-data">Specific considerations for long-read sequencing data<a class="anchor" aria-label="anchor" href="#specific-considerations-for-long-read-sequencing-data"></a></h2>



<p>Any location not reported is implicitly assumed to contain no modification.</p>
<p>According to SAM format specification,
MM base modification tags are allowed to list modifications observed not
only on the original sequenced strand (e.g., `C+m`) but also on the
opposite strand (e.g., `G-m`). The logic of their processing is as follows
(with the examples given below):</p>
<ul><li><p>if an alignment record has no methylation modifications (neither
  `C+m`, nor `G-m` are present), this record is, naturally, considered to
  be a single read with no cytosines methylated</p></li>
<li><p>if an alignment record has `C+m` modification (base modifications
  on the original sequenced strand), then this record is, naturally,
  considered to be a single read with cytosine modifications on the
  sequenced strand</p></li>
<li><p>if an alignment record has `G-m` modification (base modifications
  on the strand opposite to sequenced), then this record is treated as two
  reads, with the original sequenced strand having no modifications,
  while the opposite strand having cytosine modifications</p></li>
<li><p>if both `C+m` and `G-m` are present, then this record is treated
  as two reads, with both strands having cytosine modifications</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="preprocessGenome.html">preprocessGenome</a></code> for preloading reference
sequences and <code><a href="callMethylation.html">callMethylation</a></code> for methylation calling.</p>
<p><code><a href="generateCytosineReport.html">generateCytosineReport</a></code> for methylation statistics at
the level of individual cytosines, <code><a href="generateBedReport.html">generateBedReport</a></code> for
genomic region-based statistics, <code><a href="generateVcfReport.html">generateVcfReport</a></code> for
evaluating epiallele-SNV associations, <code><a href="extractPatterns.html">extractPatterns</a></code> for
exploring methylation patterns and <code><a href="plotPatterns.html">plotPatterns</a></code> for pretty
plotting of its output, <code><a href="generateBedEcdf.html">generateBedEcdf</a></code> for
analysing the distribution of per-read beta values, and `epialleleR`
vignettes for the description of usage and sample data.</p>
<p>Sequence Alignment/Map <a href="https://samtools.github.io/hts-specs/SAMv1.pdf" class="external-link">format specifications</a>,
specifications for <a href="https://samtools.github.io/hts-specs/SAMtags.pdf" class="external-link">optional SAM tags</a>,
duplicate alignments marking by <a href="http://www.htslib.org/doc/samtools-markdup.html" class="external-link">Samtools</a>
and <a href="https://support.illumina.com/content/dam/illumina-support/help/Illumina_DRAGEN_Bio_IT_Platform_v3_7_1000000141465/Content/SW/Informatics/Dragen/DuplicateMarking_fDG.htm" class="external-link">Illumina DRAGEN Bio IT Platform</a>.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span>  <span class="va">capture.bam</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"capture.bam"</span>, package<span class="op">=</span><span class="st">"epialleleR"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="va">bam.data</span>    <span class="op">&lt;-</span> <span class="fu">preprocessBam</span><span class="op">(</span><span class="va">capture.bam</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Checking BAM file: </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> short-read, paired-end, name-sorted alignment detected</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Reading paired-end BAM file </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [0.013s]</span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="co"># Specifics of long-read alignment processing</span></span></span>
<span class="r-in"><span>  <span class="va">out.bam</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>pattern<span class="op">=</span><span class="st">"out-"</span>, fileext<span class="op">=</span><span class="st">".bam"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="fu"><a href="simulateBam.html">simulateBam</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    seq<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ACGCCATYCGCGCCA"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    Mm<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"C+m,0,2,0;"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    Ml<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">102</span>,<span class="fl">128</span>,<span class="fl">153</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    output.bam.file<span class="op">=</span><span class="va">out.bam</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Writing sample BAM </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [0.002s]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1</span>
<span class="r-in"><span>  <span class="fu"><a href="generateCytosineReport.html">generateCytosineReport</a></span><span class="op">(</span><span class="va">out.bam</span>, threshold.reads<span class="op">=</span><span class="cn">FALSE</span>, report.context<span class="op">=</span><span class="st">"CX"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Checking BAM file: </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> long-read, single-end, unsorted alignment detected</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Reading single-end BAM file </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [0.001s]</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Preparing cytosine report </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [0.000s]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     rname strand   pos context  meth unmeth</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    &lt;fctr&gt; &lt;fctr&gt; &lt;int&gt;  &lt;fctr&gt; &lt;int&gt;  &lt;int&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1:   chrS      +     2      CG     1      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2:   chrS      +     4     CHH     0      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3:   chrS      +     5     CHH     0      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4:   chrS      +     9      CG     1      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5:   chrS      +    11      CG     1      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6:   chrS      +    13     CHH     0      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7:   chrS      +    14     CHH     0      1</span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="fu"><a href="simulateBam.html">simulateBam</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    seq<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ACGCCATYCGCGCCA"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    Mm<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"G-m,0,0,0;"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    Ml<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">138</span>,<span class="fl">101</span>,<span class="fl">96</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    output.bam.file<span class="op">=</span><span class="va">out.bam</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Writing sample BAM </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [0.001s]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1</span>
<span class="r-in"><span>  <span class="fu"><a href="generateCytosineReport.html">generateCytosineReport</a></span><span class="op">(</span><span class="va">out.bam</span>, threshold.reads<span class="op">=</span><span class="cn">FALSE</span>, report.context<span class="op">=</span><span class="st">"CX"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Checking BAM file: </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> long-read, single-end, unsorted alignment detected</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Reading single-end BAM file </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [0.001s]</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Preparing cytosine report </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [0.000s]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      rname strand   pos context  meth unmeth</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     &lt;fctr&gt; &lt;fctr&gt; &lt;int&gt;  &lt;fctr&gt; &lt;int&gt;  &lt;int&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1:   chrS      +     2      CG     0      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2:   chrS      -     3      CG     1      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3:   chrS      +     4     CHH     0      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4:   chrS      +     5     CHH     0      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  5:   chrS      +     9      CG     0      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  6:   chrS      -    10      CG     1      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  7:   chrS      +    11      CG     0      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  8:   chrS      -    12      CG     1      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  9:   chrS      +    13     CHH     0      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10:   chrS      +    14     CHH     0      1</span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span>  <span class="fu"><a href="simulateBam.html">simulateBam</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>    seq<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ACGCCATYCGCGCCA"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    Mm<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"C+m,0,2,0;G-m,0,0,0;"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    Ml<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">102</span>,<span class="fl">128</span>,<span class="fl">153</span>,<span class="fl">138</span>,<span class="fl">101</span>,<span class="fl">96</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    output.bam.file<span class="op">=</span><span class="va">out.bam</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Writing sample BAM </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [0.002s]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1</span>
<span class="r-in"><span>  <span class="fu"><a href="generateCytosineReport.html">generateCytosineReport</a></span><span class="op">(</span><span class="va">out.bam</span>, threshold.reads<span class="op">=</span><span class="cn">FALSE</span>, report.context<span class="op">=</span><span class="st">"CX"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Checking BAM file: </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> long-read, single-end, unsorted alignment detected</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Reading single-end BAM file </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [0.001s]</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Preparing cytosine report </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [0.001s]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      rname strand   pos context  meth unmeth</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     &lt;fctr&gt; &lt;fctr&gt; &lt;int&gt;  &lt;fctr&gt; &lt;int&gt;  &lt;int&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1:   chrS      +     2      CG     1      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2:   chrS      -     3      CG     1      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3:   chrS      +     4     CHH     0      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4:   chrS      +     5     CHH     0      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  5:   chrS      +     9      CG     1      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  6:   chrS      -    10      CG     1      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  7:   chrS      +    11      CG     1      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  8:   chrS      -    12      CG     1      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  9:   chrS      +    13     CHH     0      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10:   chrS      +    14     CHH     0      1</span>
<span class="r-in"><span>  </span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Oleksii Nikolaienko.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.9000.</p>
</div>

    </footer></div>





  </body></html>

