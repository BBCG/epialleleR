<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>simulateBam — simulateBam • epialleleR</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="simulateBam — simulateBam"><meta property="og:description" content="This function creates sample BAM files given mandatory and optional BAM
fields."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">epialleleR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.11.6</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../articles/epialleleR.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/values.html">The epialleleR output values &lt;img style="float: right;" src="epialleleR_logo.svg"&gt; </a>
    </li>
  </ul></li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/BBCG/epialleleR/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>simulateBam</h1>
    <small class="dont-index">Source: <a href="https://github.com/BBCG/epialleleR/blob/HEAD/R/simulateBam.R" class="external-link"><code>R/simulateBam.R</code></a></small>
    <div class="hidden name"><code>simulateBam.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function creates sample BAM files given mandatory and optional BAM
fields.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">simulateBam</span><span class="op">(</span></span>
<span>  output.bam.file <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  qname <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  flag <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  rname <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pos <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  mapq <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cigar <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  rnext <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pnext <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  tlen <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  seq <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  qual <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>output.bam.file</dt>
<dd><p>output BAM file location string. If NULL (default),
records are not written to BAM but returned as a
<code><a href="https://rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></code> object for review.</p></dd>


<dt>qname</dt>
<dd><p>character vector of query names. When default (NULL), names
like "q0001".."qNNNN" will be assigned.</p></dd>


<dt>flag</dt>
<dd><p>integer vector of bitwise flags (a combination of the BAM_F*
constants). When default (NULL), zero (i.e., unique, valid, single-end,
aligned read) is assigned for every record.</p></dd>


<dt>rname</dt>
<dd><p>character vector of chromosome (reference) names. When default
(NULL), "chrS" is assigned for every record.</p></dd>


<dt>pos</dt>
<dd><p>integer vector of 1-based leftmost coordinates of the queries.
When default (NULL), 1 is assigned for every record.</p></dd>


<dt>mapq</dt>
<dd><p>integer vector of mapping qualities. When default (NULL),
60 is assigned for every record.</p></dd>


<dt>cigar</dt>
<dd><p>character vector of CIGAR strings. When default (NULL),
"lM" is assigned for every record, where `l` is the length of the query
(`seq`).</p></dd>


<dt>rnext</dt>
<dd><p>character vector of chromosome (reference) names for next read
in template. When default (NULL), "chrS" is assigned for every record.</p></dd>


<dt>pnext</dt>
<dd><p>integer vector of 1-based leftmost coordinates of next read in
template. When default (NULL), 1 is assigned for every record.</p></dd>


<dt>tlen</dt>
<dd><p>integer vector of observed template lengths. When default
(NULL), the length of the corresponding query (`seq`)
is assigned for every record.</p></dd>


<dt>seq</dt>
<dd><p>character vector of query sequences. When default (NULL),
random sequence is assigned.
The lengths of these random sequences equal to the lengths of
methylation call strings from the `XM` optional parameter (if supplied),
or to the `tlen` parameter (if defined).
If none of these parameters is supplied, length of every `seq` will equal 10.</p></dd>


<dt>qual</dt>
<dd><p>query sequence quality strings (ASCII of base QUALity plus 33).
When default (NULL), quality of every base is assigned to "F" (QUALity
of 47 + 33). The lengths of these quality strings equal to the length of the
corresponding query sequences (`seq`) for every record.</p></dd>


<dt>...</dt>
<dd><p>optional tags to add to the records, in the form `tag=value`.
Value can be either:</p><ul><li><p>an integer vector to create a tag with a single integer value per
  alignment record (e.g., "NM" tag),</p></li>
<li><p>or a float vector to create a tag with a single float value per
  alignment record,</p></li>
<li><p>or a character vector (e.g., "XM" tag for methylation call string,
  "XG"/"YD"/"ZS" tag for reference strand read was aligned to)</p></li>
<li><p>or a list of numeric vectors to create tags array holding arrays of
  numeric values.</p></li>
</ul></dd>


<dt>verbose</dt>
<dd><p>boolean to report progress and timings (default: TRUE).</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>number of BAM records written (if `output.bam.file` is not NULL) or
<code><a href="https://rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></code> object containing final records
prepared for writing. NB: this object has 0-based coordinates and
numerically encoded reference names.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The function creates sample alignment records and saves them in BAM file.
Output can be used to test epialleleR methods as well as other
tools for methylation analysis. This method can significantly simplify
calculation of methylation metrics on example data (beta, VEF, and lMHL
values of epialleleR; methylation heterogeneity metrics of other tools).</p>
<p>The number of records written will be equal to the largest length of any
supplied (nondefault) parameter or 1 if no parameters were supplied.
If lengths of supplied parameters differ,
shorter vectors will be recycled (a whole number of times or with remainder
if necessary).</p>
<p>Please note that function performs almost no validity checks for supplied
fields. In particular, be extra careful constructing paired-end BAM
alignments, and if necessary use `samtools` to perform validity check or
manual editing after BAM-&gt;SAM conversion.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="generateCytosineReport.html">generateCytosineReport</a></code> and
<code><a href="generateMhlReport.html">generateMhlReport</a></code> for methylation reports at the level of
individual cytosines, as well as
`epialleleR` vignettes for the description of usage and sample data.</p>
<p><a href="https://www.htslib.org/" class="external-link">Samtools</a> for viewing BAM files.
<a href="http://samtools.github.io/hts-specs/SAMv1.pdf" class="external-link">SAMv1</a> file format
specifications. Specifications of
<a href="https://samtools.github.io/hts-specs/SAMtags.pdf" class="external-link">optional SAM tags</a>.
<a href="https://doi.org/10.1371/journal.pcbi.1010946" class="external-link">metheor</a> for ultrafast
DNA methylation heterogeneity calculation from bisulfite alignments.</p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span>  <span class="va">out.bam</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>pattern<span class="op">=</span><span class="st">"simulated"</span>, fileext<span class="op">=</span><span class="st">".bam"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu">simulateBam</span><span class="op">(</span></span></span>
<span class="r-in"><span>    output.bam.file<span class="op">=</span><span class="va">out.bam</span>,</span></span>
<span class="r-in"><span>    pos<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    XM<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ZZZzzZZZ"</span>, <span class="st">"ZZzzzzZZ"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    XG<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CT"</span>, <span class="st">"AG"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    xi<span class="op">=</span><span class="fl">5</span><span class="op">:</span><span class="fl">6</span>,</span></span>
<span class="r-in"><span>    xf<span class="op">=</span><span class="fl">0.05</span>,</span></span>
<span class="r-in"><span>    ai<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    af<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Writing sample BAM </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [0.002s]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2</span>
<span class="r-in"><span>  <span class="fu"><a href="generateCytosineReport.html">generateCytosineReport</a></span><span class="op">(</span><span class="va">out.bam</span>, threshold.reads<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Checking BAM file: </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> short-read, single-end, unsorted alignment detected</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Reading single-end BAM file </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [0.002s]</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Preparing cytosine report </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [0.001s]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      rname strand   pos context  meth unmeth</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     &lt;fctr&gt; &lt;fctr&gt; &lt;int&gt;  &lt;fctr&gt; &lt;int&gt;  &lt;int&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1:   chrS      +     1      CG     1      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2:   chrS      +     2      CG     1      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3:   chrS      -     2      CG     1      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4:   chrS      +     3      CG     1      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  5:   chrS      -     3      CG     1      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  6:   chrS      +     4      CG     0      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  7:   chrS      -     4      CG     0      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  8:   chrS      +     5      CG     0      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  9:   chrS      -     5      CG     0      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10:   chrS      +     6      CG     1      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11:   chrS      -     6      CG     0      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12:   chrS      +     7      CG     1      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13:   chrS      -     7      CG     0      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14:   chrS      +     8      CG     1      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15:   chrS      -     8      CG     1      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16:   chrS      -     9      CG     1      0</span>
<span class="r-in"><span>  <span class="co"># check this BAM with `samtools view` or using `output.bam.file=NULL`</span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Oleksii Nikolaienko.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.9000.</p>
</div>

      </footer></div>

  


  

  </body></html>

