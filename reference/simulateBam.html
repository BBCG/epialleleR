<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>simulateBam — simulateBam • epialleleR</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="simulateBam — simulateBam"><meta name="description" content="This function creates sample BAM files given mandatory and optional BAM
fields."><meta property="og:description" content="This function creates sample BAM files given mandatory and optional BAM
fields."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">epialleleR</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.13.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/epialleleR.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/values.html">The epialleleR output values</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/BBCG/epialleleR/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>simulateBam</h1>
      <small class="dont-index">Source: <a href="https://github.com/BBCG/epialleleR/blob/devel/R/simulateBam.R" class="external-link"><code>R/simulateBam.R</code></a></small>
      <div class="d-none name"><code>simulateBam.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function creates sample BAM files given mandatory and optional BAM
fields.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">simulateBam</span><span class="op">(</span></span>
<span>  output.bam.file <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  qname <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  flag <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  rname <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pos <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  mapq <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cigar <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  rnext <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pnext <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  tlen <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  seq <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  qual <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-output-bam-file">output.bam.file<a class="anchor" aria-label="anchor" href="#arg-output-bam-file"></a></dt>
<dd><p>output BAM file location string. If NULL (default),
records are not written to BAM but returned as a
<code><a href="https://rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></code> object for review.</p></dd>


<dt id="arg-qname">qname<a class="anchor" aria-label="anchor" href="#arg-qname"></a></dt>
<dd><p>character vector of query names. When default (NULL), names
like "q0001".."qNNNN" will be assigned.</p></dd>


<dt id="arg-flag">flag<a class="anchor" aria-label="anchor" href="#arg-flag"></a></dt>
<dd><p>integer vector of bitwise flags (a combination of the BAM_F*
constants). When default (NULL), zero (i.e., unique, valid, single-end,
aligned read) is assigned for every record.</p></dd>


<dt id="arg-rname">rname<a class="anchor" aria-label="anchor" href="#arg-rname"></a></dt>
<dd><p>character vector of chromosome (reference) names. When default
(NULL), "chrS" is assigned for every record.</p></dd>


<dt id="arg-pos">pos<a class="anchor" aria-label="anchor" href="#arg-pos"></a></dt>
<dd><p>integer vector of 1-based leftmost coordinates of the queries.
When default (NULL), 1 is assigned for every record.</p></dd>


<dt id="arg-mapq">mapq<a class="anchor" aria-label="anchor" href="#arg-mapq"></a></dt>
<dd><p>integer vector of mapping qualities. When default (NULL),
60 is assigned for every record.</p></dd>


<dt id="arg-cigar">cigar<a class="anchor" aria-label="anchor" href="#arg-cigar"></a></dt>
<dd><p>character vector of CIGAR strings. When default (NULL),
"lM" is assigned for every record, where `l` is the length of the query
(`seq`).</p></dd>


<dt id="arg-rnext">rnext<a class="anchor" aria-label="anchor" href="#arg-rnext"></a></dt>
<dd><p>character vector of chromosome (reference) names for next read
in template. When default (NULL), "chrS" is assigned for every record.</p></dd>


<dt id="arg-pnext">pnext<a class="anchor" aria-label="anchor" href="#arg-pnext"></a></dt>
<dd><p>integer vector of 1-based leftmost coordinates of next read in
template. When default (NULL), 1 is assigned for every record.</p></dd>


<dt id="arg-tlen">tlen<a class="anchor" aria-label="anchor" href="#arg-tlen"></a></dt>
<dd><p>integer vector of observed template lengths. When default
(NULL), the length of the corresponding query (`seq`)
is assigned for every record.</p></dd>


<dt id="arg-seq">seq<a class="anchor" aria-label="anchor" href="#arg-seq"></a></dt>
<dd><p>character vector of query sequences. When default (NULL),
random sequence is assigned.
The lengths of these random sequences equal to the lengths of
methylation call strings from the `XM` optional parameter (if supplied),
or to the `tlen` parameter (if defined).
If none of these parameters is supplied, length of every `seq` will equal 10.</p></dd>


<dt id="arg-qual">qual<a class="anchor" aria-label="anchor" href="#arg-qual"></a></dt>
<dd><p>query sequence quality strings (ASCII of base QUALity plus 33).
When default (NULL), quality of every base is assigned to "F" (QUALity
of 47 + 33). The lengths of these quality strings equal to the length of the
corresponding query sequences (`seq`) for every record.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>optional tags to add to the records, in the form `tag=value`.
Value can be either:</p><ul><li><p>an integer vector to create a tag with a single integer value per
  alignment record (e.g., "NM" tag),</p></li>
<li><p>or a float vector to create a tag with a single float value per
  alignment record,</p></li>
<li><p>or a character vector (e.g., "XM" tag for methylation call string,
  "XG"/"YD"/"ZS" tag for reference strand read was aligned to)</p></li>
<li><p>or a list of numeric vectors to create tags array holding arrays of
  numeric values.</p></li>
</ul></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>boolean to report progress and timings (default: TRUE).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>number of BAM records written (if `output.bam.file` is not NULL) or
<code><a href="https://rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></code> object containing final records
prepared for writing. NB: this object has 0-based coordinates and
numerically encoded reference names.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function creates sample alignment records and saves them in BAM file.
Output can be used to test epialleleR methods as well as other
tools for methylation analysis. This method can significantly simplify
calculation of methylation metrics on example data (beta, VEF, and lMHL
values of epialleleR; methylation heterogeneity metrics of other tools).</p>
<p>The number of records written will be equal to the largest length of any
supplied (nondefault) parameter or 1 if no parameters were supplied.
If lengths of supplied parameters differ,
shorter vectors will be recycled (a whole number of times or with remainder
if necessary).</p>
<p>Please note that function performs almost no validity checks for supplied
fields. In particular, be extra careful constructing paired-end BAM
alignments, and if necessary use `samtools` to perform validity check or
manual editing after BAM-&gt;SAM conversion.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="generateCytosineReport.html">generateCytosineReport</a></code> and
<code><a href="generateMhlReport.html">generateMhlReport</a></code> for methylation reports at the level of
individual cytosines, as well as
`epialleleR` vignettes for the description of usage and sample data.</p>
<p><a href="https://www.htslib.org/" class="external-link">Samtools</a> for viewing BAM files.
<a href="http://samtools.github.io/hts-specs/SAMv1.pdf" class="external-link">SAMv1</a> file format
specifications. Specifications of
<a href="https://samtools.github.io/hts-specs/SAMtags.pdf" class="external-link">optional SAM tags</a>.
<a href="https://doi.org/10.1371/journal.pcbi.1010946" class="external-link">metheor</a> for ultrafast
DNA methylation heterogeneity calculation from bisulfite alignments.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span>  <span class="va">out.bam</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>pattern<span class="op">=</span><span class="st">"simulated"</span>, fileext<span class="op">=</span><span class="st">".bam"</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu">simulateBam</span><span class="op">(</span></span></span>
<span class="r-in"><span>    output.bam.file<span class="op">=</span><span class="va">out.bam</span>,</span></span>
<span class="r-in"><span>    pos<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    XM<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"ZZZzzZZZ"</span>, <span class="st">"ZZzzzzZZ"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    XG<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CT"</span>, <span class="st">"AG"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    xi<span class="op">=</span><span class="fl">5</span><span class="op">:</span><span class="fl">6</span>,</span></span>
<span class="r-in"><span>    xf<span class="op">=</span><span class="fl">0.05</span>,</span></span>
<span class="r-in"><span>    ai<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4</span><span class="op">:</span><span class="fl">6</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>    af<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0.5</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Writing sample BAM </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [0.002s]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2</span>
<span class="r-in"><span>  <span class="fu"><a href="generateCytosineReport.html">generateCytosineReport</a></span><span class="op">(</span><span class="va">out.bam</span>, threshold.reads<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Checking BAM file: </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> short-read, single-end, unsorted alignment detected</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Reading single-end BAM file </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [0.001s]</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Preparing cytosine report </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> [0.000s]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      rname strand   pos context  meth unmeth</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     &lt;fctr&gt; &lt;fctr&gt; &lt;int&gt;  &lt;fctr&gt; &lt;int&gt;  &lt;int&gt;</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1:   chrS      +     1      CG     1      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2:   chrS      +     2      CG     1      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  3:   chrS      -     2      CG     1      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4:   chrS      +     3      CG     1      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  5:   chrS      -     3      CG     1      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  6:   chrS      +     4      CG     0      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  7:   chrS      -     4      CG     0      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  8:   chrS      +     5      CG     0      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  9:   chrS      -     5      CG     0      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10:   chrS      +     6      CG     1      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11:   chrS      -     6      CG     0      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 12:   chrS      +     7      CG     1      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 13:   chrS      -     7      CG     0      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 14:   chrS      +     8      CG     1      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 15:   chrS      -     8      CG     1      0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 16:   chrS      -     9      CG     1      0</span>
<span class="r-in"><span>  <span class="co"># check this BAM with `samtools view` or using `output.bam.file=NULL`</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Oleksii Nikolaienko.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.9000.</p>
</div>

    </footer></div>





  </body></html>

