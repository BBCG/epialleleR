<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>The epialleleR output values <img style="float: right;" src="epialleleR_logo.svg">  â€¢ epialleleR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="The epialleleR output values &lt;img style=" float: right src="epialleleR_logo.svg">
</head>
<body>
<p> " /&gt;
<meta property="og:description" content="epialleleR"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></p>
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">epialleleR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.11.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../articles/epialleleR.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/values.html">The epialleleR output values &lt;img style="float: right;" src="epialleleR_logo.svg"&gt; </a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/BBCG/epialleleR/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>The epialleleR output values
<img style="float: right;" src="epialleleR_logo.svg">
</h1>
            
            <h4 data-toc-skip class="date">11 February, 2024</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/BBCG/epialleleR/blob/HEAD/vignettes/values.Rmd" class="external-link"><code>vignettes/values.Rmd</code></a></small>
      <div class="hidden name"><code>values.Rmd</code></div>

    </div>

    
        <div class="abstract">
      <p class="abstract">Abstract</p>
      <p>A comparison and visualisation of epialleleR output values for
      various input files</p>
    </div>
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The best possible explanation on VEF and lMHL values is given in help
files for <em><code>generateCytosineReport</code></em> and
<em><code>generateMhlReport</code></em> methods, respectively. Here we
try to show some simplified and real situations, i.e., different
methylation patterns that may exist, and provide a visual summary of
<em><code>epialleleR</code></em> output.</p>
<p>The readers are welcome to try their own real and simulated data. If
it might be of interest to others, please create an issue and these
examples might get included in this vignette.</p>
<p>NB: the <code>plotMetrics</code> function used below is a piece of
spaghetti code, hence hidden. If you still want to use it or see what it
does - browse a <a href="https://github.com/BBCG/epialleleR/blob/devel/vignettes/values.Rmd" class="external-link">source
code</a> of this vignette online.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">out.bam</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span>pattern<span class="op">=</span><span class="st">"simulated"</span>, fileext<span class="op">=</span><span class="st">".bam"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># no epimutations</span></span>
<span><span class="fu"><a href="../reference/simulateBam.html">simulateBam</a></span><span class="op">(</span></span>
<span>  output.bam.file<span class="op">=</span><span class="va">out.bam</span>,</span>
<span>  XM<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">1000</span>, <span class="kw">function</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Z"</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"z"</span>, <span class="fl">9</span><span class="op">)</span><span class="op">)</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      <span class="va">paste</span>, collapse<span class="op">=</span><span class="st">""</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  XG<span class="op">=</span><span class="st">"CT"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Writing sample BAM [0.125s]</span></span>
<span><span class="co">#&gt; [1] 1000</span></span>
<span><span class="fu">plotMetrics</span><span class="op">(</span><span class="va">out.bam</span>, <span class="fu">as</span><span class="op">(</span><span class="st">"chrS:1-10"</span>, <span class="st">"GRanges"</span><span class="op">)</span>, <span class="fl">0</span>, title<span class="op">=</span><span class="st">"no epimutations"</span><span class="op">)</span></span></code></pre></div>
<p><img src="values_files/figure-html/unnamed-chunk-3-1.png" width="100%" height="100%"></p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># one complete epimutation</span></span>
<span><span class="fu"><a href="../reference/simulateBam.html">simulateBam</a></span><span class="op">(</span></span>
<span>  output.bam.file<span class="op">=</span><span class="va">out.bam</span>,</span>
<span>  XM<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Z"</span>, <span class="fl">10</span><span class="op">)</span>, collapse<span class="op">=</span><span class="st">""</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">999</span>, <span class="kw">function</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Z"</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"z"</span>, <span class="fl">9</span><span class="op">)</span><span class="op">)</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      <span class="va">paste</span>, collapse<span class="op">=</span><span class="st">""</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  XG<span class="op">=</span><span class="st">"CT"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Writing sample BAM [0.098s]</span></span>
<span><span class="co">#&gt; [1] 1000</span></span>
<span><span class="fu">plotMetrics</span><span class="op">(</span><span class="va">out.bam</span>, <span class="fu">as</span><span class="op">(</span><span class="st">"chrS:1-10"</span>, <span class="st">"GRanges"</span><span class="op">)</span>, title<span class="op">=</span><span class="st">"one complete epimutation"</span><span class="op">)</span></span></code></pre></div>
<p><img src="values_files/figure-html/unnamed-chunk-3-2.png" width="100%" height="100%"></p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># one partial epimutation</span></span>
<span><span class="fu"><a href="../reference/simulateBam.html">simulateBam</a></span><span class="op">(</span></span>
<span>  output.bam.file<span class="op">=</span><span class="va">out.bam</span>,</span>
<span>  XM<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Z"</span>, <span class="fl">4</span><span class="op">)</span>, <span class="st">"z"</span>, <span class="st">"z"</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Z"</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span>, collapse<span class="op">=</span><span class="st">""</span><span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">999</span>, <span class="kw">function</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Z"</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"z"</span>, <span class="fl">9</span><span class="op">)</span><span class="op">)</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      <span class="va">paste</span>, collapse<span class="op">=</span><span class="st">""</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  XG<span class="op">=</span><span class="st">"CT"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Writing sample BAM [0.133s]</span></span>
<span><span class="co">#&gt; [1] 1000</span></span>
<span><span class="fu">plotMetrics</span><span class="op">(</span><span class="va">out.bam</span>, <span class="fu">as</span><span class="op">(</span><span class="st">"chrS:1-10"</span>, <span class="st">"GRanges"</span><span class="op">)</span>, title<span class="op">=</span><span class="st">"one partial epimutation"</span><span class="op">)</span></span></code></pre></div>
<p><img src="values_files/figure-html/unnamed-chunk-3-3.png" width="100%" height="100%"></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># another partial epimutation</span></span>
<span><span class="fu"><a href="../reference/simulateBam.html">simulateBam</a></span><span class="op">(</span></span>
<span>  output.bam.file<span class="op">=</span><span class="va">out.bam</span>,</span>
<span>  XM<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"zZZZZZZZzz"</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">999</span>, <span class="kw">function</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Z"</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"z"</span>, <span class="fl">9</span><span class="op">)</span><span class="op">)</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      <span class="va">paste</span>, collapse<span class="op">=</span><span class="st">""</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  XG<span class="op">=</span><span class="st">"CT"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Writing sample BAM [0.102s]</span></span>
<span><span class="co">#&gt; [1] 1000</span></span>
<span><span class="fu">plotMetrics</span><span class="op">(</span><span class="va">out.bam</span>, <span class="fu">as</span><span class="op">(</span><span class="st">"chrS:1-10"</span>, <span class="st">"GRanges"</span><span class="op">)</span>, title<span class="op">=</span><span class="st">"another partial epimutation"</span><span class="op">)</span></span></code></pre></div>
<p><img src="values_files/figure-html/unnamed-chunk-3-4.png" width="100%" height="100%"></p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># several partial epimutations</span></span>
<span><span class="fu"><a href="../reference/simulateBam.html">simulateBam</a></span><span class="op">(</span></span>
<span>  output.bam.file<span class="op">=</span><span class="va">out.bam</span>,</span>
<span>  XM<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="kw">function</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Z"</span>, <span class="fl">6</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"z"</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      <span class="va">paste</span>, collapse<span class="op">=</span><span class="st">""</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">999</span>, <span class="kw">function</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Z"</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"z"</span>, <span class="fl">9</span><span class="op">)</span><span class="op">)</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      <span class="va">paste</span>, collapse<span class="op">=</span><span class="st">""</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  XG<span class="op">=</span><span class="st">"CT"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Writing sample BAM [0.110s]</span></span>
<span><span class="co">#&gt; [1] 1009</span></span>
<span><span class="fu">plotMetrics</span><span class="op">(</span><span class="va">out.bam</span>, <span class="fu">as</span><span class="op">(</span><span class="st">"chrS:1-10"</span>, <span class="st">"GRanges"</span><span class="op">)</span>, title<span class="op">=</span><span class="st">"several partial epimutations"</span><span class="op">)</span></span></code></pre></div>
<p><img src="values_files/figure-html/unnamed-chunk-3-5.png" width="100%" height="100%"></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># several short partial epimutations</span></span>
<span><span class="fu"><a href="../reference/simulateBam.html">simulateBam</a></span><span class="op">(</span></span>
<span>  output.bam.file<span class="op">=</span><span class="va">out.bam</span>,</span>
<span>  XM<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="kw">function</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"Z"</span>, <span class="fl">4</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"z"</span>, <span class="fl">6</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      <span class="va">paste</span>, collapse<span class="op">=</span><span class="st">""</span></span>
<span>    <span class="op">)</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">999</span>, <span class="kw">function</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Z"</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"z"</span>, <span class="fl">9</span><span class="op">)</span><span class="op">)</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      <span class="va">paste</span>, collapse<span class="op">=</span><span class="st">""</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  XG<span class="op">=</span><span class="st">"CT"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Writing sample BAM [0.103s]</span></span>
<span><span class="co">#&gt; [1] 1009</span></span>
<span><span class="fu">plotMetrics</span><span class="op">(</span><span class="va">out.bam</span>, <span class="fu">as</span><span class="op">(</span><span class="st">"chrS:1-10"</span>, <span class="st">"GRanges"</span><span class="op">)</span>, title<span class="op">=</span><span class="st">"several short partial epimutations"</span><span class="op">)</span></span></code></pre></div>
<p><img src="values_files/figure-html/unnamed-chunk-3-6.png" width="100%" height="100%"></p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># several overlapping partial epimutations</span></span>
<span><span class="fu"><a href="../reference/simulateBam.html">simulateBam</a></span><span class="op">(</span></span>
<span>  output.bam.file<span class="op">=</span><span class="va">out.bam</span>,</span>
<span>  pos<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,</span>
<span>  XM<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"ZZZZZZZZZZ"</span>, <span class="st">"ZZZZZZZZZz"</span>, <span class="st">"ZZZZZZZZzz"</span>, <span class="st">"ZZZZZZZzzz"</span>, <span class="st">"ZZZZZZzzzz"</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">15</span>, <span class="kw">function</span> <span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Z"</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"z"</span>, <span class="fl">9</span><span class="op">)</span><span class="op">)</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      <span class="va">paste</span>, collapse<span class="op">=</span><span class="st">""</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  XG<span class="op">=</span><span class="st">"CT"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Writing sample BAM [0.006s]</span></span>
<span><span class="co">#&gt; [1] 20</span></span>
<span><span class="fu">plotMetrics</span><span class="op">(</span><span class="va">out.bam</span>, <span class="fu">as</span><span class="op">(</span><span class="st">"chrS:1-20"</span>, <span class="st">"GRanges"</span><span class="op">)</span>, title<span class="op">=</span><span class="st">"several overlapping partial epimutations"</span><span class="op">)</span></span></code></pre></div>
<p><img src="values_files/figure-html/unnamed-chunk-3-7.png" width="100%" height="100%"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># amplicon 0%</span></span>
<span><span class="fu">plotMetrics</span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"amplicon000meth.bam"</span>, package<span class="op">=</span><span class="st">"epialleleR"</span><span class="op">)</span>,</span>
<span>  <span class="fu">as</span><span class="op">(</span><span class="st">"chr17:43124861-43126026"</span>, <span class="st">"GRanges"</span><span class="op">)</span>, title<span class="op">=</span><span class="st">"amplicon, 0%"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="values_files/figure-html/unnamed-chunk-3-8.png" width="100%" height="100%"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># amplicon 10%</span></span>
<span><span class="fu">plotMetrics</span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"amplicon010meth.bam"</span>, package<span class="op">=</span><span class="st">"epialleleR"</span><span class="op">)</span>,</span>
<span>  <span class="fu">as</span><span class="op">(</span><span class="st">"chr17:43124861-43126026"</span>, <span class="st">"GRanges"</span><span class="op">)</span>, title<span class="op">=</span><span class="st">"amplicon, 10%"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="values_files/figure-html/unnamed-chunk-3-9.png" width="100%" height="100%"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># sample capture, BMP7</span></span>
<span><span class="fu">plotMetrics</span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"capture.bam"</span>, package<span class="op">=</span><span class="st">"epialleleR"</span><span class="op">)</span>,</span>
<span>  <span class="fu">as</span><span class="op">(</span><span class="st">"chr20:57266125-57268185:+"</span>, <span class="st">"GRanges"</span><span class="op">)</span>, title<span class="op">=</span><span class="st">"sample capture, BMP7, + strand"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="values_files/figure-html/unnamed-chunk-3-10.png" width="100%" height="100%"></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># sample capture, BMP7</span></span>
<span><span class="fu">plotMetrics</span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"capture.bam"</span>, package<span class="op">=</span><span class="st">"epialleleR"</span><span class="op">)</span>,</span>
<span>  <span class="fu">as</span><span class="op">(</span><span class="st">"chr20:57266125-57268185:-"</span>, <span class="st">"GRanges"</span><span class="op">)</span>, title<span class="op">=</span><span class="st">"sample capture, BMP7, - strand"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="values_files/figure-html/unnamed-chunk-3-11.png" width="100%" height="100%"></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># sample capture, RAD51C</span></span>
<span><span class="fu">plotMetrics</span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"capture.bam"</span>, package<span class="op">=</span><span class="st">"epialleleR"</span><span class="op">)</span>,</span>
<span>  <span class="fu">as</span><span class="op">(</span><span class="st">"chr17:58691673-58693108:+"</span>, <span class="st">"GRanges"</span><span class="op">)</span>, title<span class="op">=</span><span class="st">"sample capture, RAD51C, + strand"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="values_files/figure-html/unnamed-chunk-3-12.png" width="100%" height="100%"></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># sample capture, RAD51C</span></span>
<span><span class="fu">plotMetrics</span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"capture.bam"</span>, package<span class="op">=</span><span class="st">"epialleleR"</span><span class="op">)</span>,</span>
<span>  <span class="fu">as</span><span class="op">(</span><span class="st">"chr17:58691673-58693108:-"</span>, <span class="st">"GRanges"</span><span class="op">)</span>, title<span class="op">=</span><span class="st">"sample capture, RAD51C, - strand"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="values_files/figure-html/unnamed-chunk-3-13.png" width="100%" height="100%"></p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># long-read sequencing, low methylation</span></span>
<span><span class="va">getXM</span> <span class="op">&lt;-</span> <span class="kw">function</span> <span class="op">(</span><span class="va">p</span><span class="op">)</span> <span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span>x<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"z"</span>, <span class="st">"Z"</span><span class="op">)</span>, size<span class="op">=</span><span class="fl">1</span>, prob<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">p</span>, <span class="fl">1</span><span class="op">-</span><span class="va">p</span><span class="op">)</span><span class="op">)</span><span class="op">}</span></span>
<span><span class="va">probs</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="op">-</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span>, <span class="op">+</span><span class="fl">1</span><span class="op">*</span><span class="va">pi</span>, by <span class="op">=</span> <span class="va">pi</span><span class="op">/</span><span class="fl">125</span><span class="op">)</span><span class="op">)</span><span class="op">+</span><span class="fl">2</span><span class="op">)</span><span class="op">/</span><span class="fl">3</span></span>
<span><span class="fu"><a href="../reference/simulateBam.html">simulateBam</a></span><span class="op">(</span></span>
<span>  output.bam.file<span class="op">=</span><span class="va">out.bam</span>,</span>
<span>  pos<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,</span>
<span>  XM<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="kw">function</span> <span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">probs</span>, <span class="va">getXM</span><span class="op">)</span>, collapse<span class="op">=</span><span class="st">""</span><span class="op">)</span><span class="op">}</span><span class="op">)</span>,</span>
<span>  XG<span class="op">=</span><span class="st">"CT"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Writing sample BAM [0.032s]</span></span>
<span><span class="co">#&gt; [1] 10</span></span>
<span><span class="fu">plotMetrics</span><span class="op">(</span><span class="va">out.bam</span>, <span class="fu">as</span><span class="op">(</span><span class="st">"chrS:1-1000"</span>, <span class="st">"GRanges"</span><span class="op">)</span>, title<span class="op">=</span><span class="st">"long-read sequencing, low methylation"</span><span class="op">)</span></span></code></pre></div>
<p><img src="values_files/figure-html/unnamed-chunk-3-14.png" width="100%" height="100%"></p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># long-read sequencing, high methylation</span></span>
<span><span class="fu"><a href="../reference/simulateBam.html">simulateBam</a></span><span class="op">(</span></span>
<span>  output.bam.file<span class="op">=</span><span class="va">out.bam</span>,</span>
<span>  pos<span class="op">=</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,</span>
<span>  XM<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="kw">function</span> <span class="op">(</span><span class="va">i</span><span class="op">)</span> <span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">-</span><span class="va">probs</span>, <span class="va">getXM</span><span class="op">)</span>, collapse<span class="op">=</span><span class="st">""</span><span class="op">)</span><span class="op">}</span><span class="op">)</span>,</span>
<span>  XG<span class="op">=</span><span class="st">"CT"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; Writing sample BAM [0.030s]</span></span>
<span><span class="co">#&gt; [1] 10</span></span>
<span><span class="fu">plotMetrics</span><span class="op">(</span><span class="va">out.bam</span>, <span class="fu">as</span><span class="op">(</span><span class="st">"chrS:1-1000"</span>, <span class="st">"GRanges"</span><span class="op">)</span>, title<span class="op">=</span><span class="st">"long-read sequencing, high methylation"</span><span class="op">)</span></span></code></pre></div>
<p><img src="values_files/figure-html/unnamed-chunk-3-15.png" width="100%" height="100%"></p>
<div class="section level3">
<h3 id="session-info">Session Info<a class="anchor" aria-label="anchor" href="#session-info"></a>
</h3>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html" class="external-link">sessionInfo</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; R Under development (unstable) (2024-02-07 r85873)</span></span>
<span><span class="co">#&gt; Platform: x86_64-pc-linux-gnu</span></span>
<span><span class="co">#&gt; Running under: Ubuntu 22.04.3 LTS</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Matrix products: default</span></span>
<span><span class="co">#&gt; BLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 </span></span>
<span><span class="co">#&gt; LAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/libopenblasp-r0.3.20.so;  LAPACK version 3.10.0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; locale:</span></span>
<span><span class="co">#&gt;  [1] LC_CTYPE=en_US.UTF-8       LC_NUMERIC=C               LC_TIME=en_US.UTF-8       </span></span>
<span><span class="co">#&gt;  [4] LC_COLLATE=en_US.UTF-8     LC_MONETARY=en_US.UTF-8    LC_MESSAGES=en_US.UTF-8   </span></span>
<span><span class="co">#&gt;  [7] LC_PAPER=en_US.UTF-8       LC_NAME=C                  LC_ADDRESS=C              </span></span>
<span><span class="co">#&gt; [10] LC_TELEPHONE=C             LC_MEASUREMENT=en_US.UTF-8 LC_IDENTIFICATION=C       </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; time zone: UTC</span></span>
<span><span class="co">#&gt; tzcode source: system (glibc)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; attached base packages:</span></span>
<span><span class="co">#&gt; [1] stats4    stats     graphics  grDevices utils     datasets  methods   base     </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; other attached packages:</span></span>
<span><span class="co">#&gt; [1] epialleleR_1.11.4    gridExtra_2.3        ggplot2_3.4.4        GenomicRanges_1.55.2</span></span>
<span><span class="co">#&gt; [5] GenomeInfoDb_1.39.6  IRanges_2.37.1       S4Vectors_0.41.3     BiocGenerics_0.49.1 </span></span>
<span><span class="co">#&gt; [9] data.table_1.15.0   </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; loaded via a namespace (and not attached):</span></span>
<span><span class="co">#&gt;   [1] DBI_1.2.1                   bitops_1.0-7                httr2_1.0.0                </span></span>
<span><span class="co">#&gt;   [4] biomaRt_2.59.1              rlang_1.1.3                 magrittr_2.0.3             </span></span>
<span><span class="co">#&gt;   [7] matrixStats_1.2.0           compiler_4.4.0              RSQLite_2.3.5              </span></span>
<span><span class="co">#&gt;  [10] GenomicFeatures_1.55.3      png_0.1-8                   systemfonts_1.0.5          </span></span>
<span><span class="co">#&gt;  [13] vctrs_0.6.5                 stringr_1.5.1               pkgconfig_2.0.3            </span></span>
<span><span class="co">#&gt;  [16] crayon_1.5.2                fastmap_1.1.1               dbplyr_2.4.0               </span></span>
<span><span class="co">#&gt;  [19] XVector_0.43.1              labeling_0.4.3              utf8_1.2.4                 </span></span>
<span><span class="co">#&gt;  [22] Rsamtools_2.19.3            rmarkdown_2.25              ragg_1.2.7                 </span></span>
<span><span class="co">#&gt;  [25] purrr_1.0.2                 bit_4.0.5                   xfun_0.42                  </span></span>
<span><span class="co">#&gt;  [28] zlibbioc_1.49.0             cachem_1.0.8                jsonlite_1.8.8             </span></span>
<span><span class="co">#&gt;  [31] progress_1.2.3              blob_1.2.4                  highr_0.10                 </span></span>
<span><span class="co">#&gt;  [34] DelayedArray_0.29.1         BiocParallel_1.37.0         parallel_4.4.0             </span></span>
<span><span class="co">#&gt;  [37] prettyunits_1.2.0           R6_2.5.1                    VariantAnnotation_1.49.6   </span></span>
<span><span class="co">#&gt;  [40] RColorBrewer_1.1-3          bslib_0.6.1                 stringi_1.8.3              </span></span>
<span><span class="co">#&gt;  [43] rtracklayer_1.63.0          jquerylib_0.1.4             Rcpp_1.0.12                </span></span>
<span><span class="co">#&gt;  [46] SummarizedExperiment_1.33.3 knitr_1.45                  Matrix_1.6-5               </span></span>
<span><span class="co">#&gt;  [49] tidyselect_1.2.0            abind_1.4-5                 yaml_2.3.8                 </span></span>
<span><span class="co">#&gt;  [52] codetools_0.2-19            curl_5.2.0                  lattice_0.22-5             </span></span>
<span><span class="co">#&gt;  [55] tibble_3.2.1                Biobase_2.63.0              withr_3.0.0                </span></span>
<span><span class="co">#&gt;  [58] KEGGREST_1.43.0             evaluate_0.23               desc_1.4.3                 </span></span>
<span><span class="co">#&gt;  [61] BiocFileCache_2.11.1        xml2_1.3.6                  Biostrings_2.71.2          </span></span>
<span><span class="co">#&gt;  [64] pillar_1.9.0                filelock_1.0.3              MatrixGenerics_1.15.0      </span></span>
<span><span class="co">#&gt;  [67] generics_0.1.3              RCurl_1.98-1.14             hms_1.1.3                  </span></span>
<span><span class="co">#&gt;  [70] munsell_0.5.0               scales_1.3.0                glue_1.7.0                 </span></span>
<span><span class="co">#&gt;  [73] tools_4.4.0                 BiocIO_1.13.0               BSgenome_1.71.2            </span></span>
<span><span class="co">#&gt;  [76] GenomicAlignments_1.39.2    XML_3.99-0.16.1             fs_1.6.3                   </span></span>
<span><span class="co">#&gt;  [79] grid_4.4.0                  AnnotationDbi_1.65.2        colorspace_2.1-0           </span></span>
<span><span class="co">#&gt;  [82] GenomeInfoDbData_1.2.11     restfulr_0.0.15             cli_3.6.2                  </span></span>
<span><span class="co">#&gt;  [85] rappdirs_0.3.3              textshaping_0.3.7           fansi_1.0.6                </span></span>
<span><span class="co">#&gt;  [88] S4Arrays_1.3.3              dplyr_1.1.4                 gtable_0.3.4               </span></span>
<span><span class="co">#&gt;  [91] sass_0.4.8                  digest_0.6.34               SparseArray_1.3.3          </span></span>
<span><span class="co">#&gt;  [94] farver_2.1.1                rjson_0.2.21                memoise_2.0.1              </span></span>
<span><span class="co">#&gt;  [97] htmltools_0.5.7             pkgdown_2.0.7.9000          lifecycle_1.0.4            </span></span>
<span><span class="co">#&gt; [100] httr_1.4.7                  bit64_4.0.5</span></span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Oleksii Nikolaienko.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.9000.</p>
</div>

      </footer>
</div>

  


  

  
</body>
</html>
